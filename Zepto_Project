CREATE DATABASE ZEPTO;

create or replace table zepto (
category VARCHAR(120),
name VARCHAR(150) NOT NULL,
mrp NUMERIC(8,2),
discountPercent NUMERIC(5,2),
availableQuantity INTEGER,
discountedSellingPrice NUMERIC(8,2),
weightInGms INTEGER,
outOfStock BOOLEAN,	
quantity INTEGER
);

SELECT * FROM ZEPTO;

--different product categories
SELECT DISTINCT(CATEGORY)
FROM ZEPTO
ORDER BY CATEGORY;

--products in stock vs out of stock
SELECT 
CASE 
    WHEN OUTOFSTOCK = 'TRUE' THEN 'OUTOFSTOCK'
ELSE 'INSTOCK'
END AS STOCK_VS_OUT_OF_STOCK,
COUNT(*) AS PRODUCT_COUNT
FROM ZEPTO
GROUP BY 1;

--products with price = 0     (1 PRODUCT MRP IS 0)

SELECT * 
FROM ZEPTO
WHERE MRP=0;

DELETE FROM ZEPTO
WHERE MRP=0;

-- CHECK

SELECT * 
FROM ZEPTO
WHERE MRP=0;


--convert paise to rupees

UPDATE zepto
SET mrp = mrp / 100.0,
discountedSellingPrice = discountedSellingPrice / 100.0;

SELECT mrp, discountedSellingPrice FROM zepto;


-- Q1. Find the top 10 best-value products based on the discount percentage.

SELECT NAME,MRP,DISCOUNTPERCENT
FROM ZEPTO
ORDER BY DISCOUNTPERCENT DESC
LIMIT 10;

--Q2.What are the Products with High MRP > 350 but Out of Stock
SELECT DISTINCT NAME,MRP
FROM ZEPTO
WHERE OUTOFSTOCK='TRUE' AND MRP > 350
ORDER BY MRP DESC;

--Q3.Calculate Estimated Revenue for each category

SELECT CATEGORY,
SUM(DISCOUNTEDSELLINGPRICE * AVAILABLEQUANTITY) AS TOT_REVENUE
FROM ZEPTO
GROUP BY CATEGORY
ORDER BY TOT_REVENUE DESC;

-- Q4. Find all products where MRP is greater than â‚¹500 and discount is less than 10%.


SELECT CATEGORY,MRP,DISCOUNTPERCENT
FROM ZEPTO
WHERE MRP>500 AND DISCOUNTPERCENT < 10
ORDER BY MRP DESC,DISCOUNTPERCENT;

-- Q5. Identify the top 5 categories offering the highest average discount percentage.

SELECT CATEGORY,
ROUND(AVG(DISCOUNTPERCENT),2) AS HIGHEST_DISCOUNT_PERCENT
FROM ZEPTO
GROUP BY CATEGORY
ORDER BY HIGHEST_DISCOUNT_PERCENT DESC
LIMIT 5;


-- Q6. Find the price per gram for products above 100g and sort by best value.

SELECT DISTINCT NAME,
WEIGHTINGMS,
DISCOUNTEDSELLINGPRICE,
ROUND(DISCOUNTEDSELLINGPRICE/NULLIF(WEIGHTINGMS,0),2) AS PER_GRAM_PRICE
FROM ZEPTO
WHERE WEIGHTINGMS > 100
ORDER BY PER_GRAM_PRICE ASC;

--Q7.Group the products into categories like Low, Medium, Bulk.

SELECT DISTINCT NAME, WEIGHTINGMS,
CASE 
    WHEN WEIGHTINGMS < 1000 THEN 'LOW'
    WHEN WEIGHTINGMS < 5000 THEN 'MEDIUM'
    ELSE 'BULK'
    END AS WEIGHT_CATEGORY
FROM ZEPTO;

--Q8.What is the Total Inventory Weight Per Category 

SELECT CATEGORY,
SUM(AVAILABLEQUANTITY * WEIGHTINGMS) AS TOT_WEIGHTS_IN_GRAM
FROM ZEPTO
GROUP BY 1
ORDER BY TOT_WEIGHTS_IN_GRAM DESC;


--Q8.What is the Total Inventory Weight Per Category IN KILOGRAM


SELECT CATEGORY,
ROUND(SUM(AVAILABLEQUANTITY * WEIGHTINGMS)/1000,2) AS TOT_WEIGHTS_IN_KILOGRAM
FROM ZEPTO
GROUP BY 1
ORDER BY TOT_WEIGHTS_IN_KILOGRAM DESC;

SELECT * FROM ZEPTO;
